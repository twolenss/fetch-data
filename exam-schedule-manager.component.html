<h2 style="margin-bottom: 15px; color: #1565C0;">Code Summary</h2>
<!-- FORM SECTION -->
<form style="display: flex; flex-direction: column; gap: 15px; padding: 20px; background: #ffffff; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">

  <!-- TERM & START DATE IN ONE ROW -->
  <div style="display: flex; align-items: center; gap: 20px;">

    <!-- TERM & SCHOOL YEAR -->
    <div style="display: flex; align-items: center;">
      <label style="width: 150px; font-weight: 500; color: #0D47A1;">Term & School Year:</label>

      <mat-form-field appearance="outline" style="width: 250px;">
        <mat-label>Select Term & School Year</mat-label>
        <mat-select [(ngModel)]="activeTerm" name="activeTerm">
          <mat-option *ngFor="let item of combinedOptions" [value]="item.value">
            {{ item.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- FETCH BUTTON -->
  <div>
    <button mat-raised-button color="primary" (click)="selectTermYear()">Fetch</button>
  </div>
  </div>


</form>

<hr style="margin: 20px 0; border: 1px solid #000000;">


<!-- START DATE SELECTION -->
<div style="display: flex; align-items: center; gap: 20px; background: #fdfdfd; padding: 20px; border-radius: 10px;">
  <mat-form-field appearance="outline" style="width: 250px;">
    <mat-label>Select Start Date</mat-label>
    <input matInput
      [matDatepicker]="picker"
      [(ngModel)]="startDate"
      name="startDate">
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>

  <!-- GENERATE BUTTON -->
  <div>
    <button mat-raised-button color="primary" (click)="generateSchedule()">Generate Schedule</button>
  </div>

</div>

<!-- GENERATED SCHEDULE DISPLAY -->
<div *ngIf="generatedSchedule.length > 0" style="margin-top: 30px;">
  <h3 style="color: #1565C0;">Generated Schedule</h3>

  <mat-accordion multi>
    <mat-expansion-panel *ngFor="let item of generatedSchedule" style="margin-bottom: 10px;">
      <mat-expansion-panel-header style="background: #294a70;">
        <mat-panel-title style="color: #ffffff; font-weight: 600;">
          {{ item.subjectId }} â€” {{ item.title }}
        </mat-panel-title>
        <mat-panel-description style="color: #ffffff;">
          Day: {{ item.day }} | Time: {{ item.time }}
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div style="padding: 10px 20px; background: #ffffff;">
        <table mat-table [dataSource]="item.codes" class="mat-elevation-z2" style="width: 100%; background: white; border-radius: 6px;">
          

          <!-- Code No-->
          <ng-container matColumnDef="codeNo">
            <th mat-header-cell *matHeaderCellDef style="color: #0D47A1;">Code No</th>
            <td mat-cell *matCellDef="let code">{{ code.codeNo }}</td>
          </ng-container>

          <!-- Course -->
          <ng-container matColumnDef="course">
            <th mat-header-cell *matHeaderCellDef style="color: #0D47A1;">Course</th>
            <td mat-cell *matCellDef="let code">{{ code.course }}</td>
          </ng-container>

          <!-- Year -->
          <ng-container matColumnDef="year">
            <th mat-header-cell *matHeaderCellDef style="color: #0D47A1;">Year</th>
            <td mat-cell *matCellDef="let code">{{ code.year }}</td>
          </ng-container>

          <!-- Department -->
          <ng-container matColumnDef="dept">
            <th mat-header-cell *matHeaderCellDef style="color: #0D47A1;">Department</th>
            <td mat-cell *matCellDef="let code">{{ code.dept }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['codeNo','course','year','dept']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['codeNo','course','year','dept'];"></tr>
        </table>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>

<!-- No Data -->
<div *ngIf="generatedSchedule.length === 0" style="text-align: center; color: #1976D2; margin-top: 20px;">
  <p>No generated schedule yet. Please select a term and click <strong>Generate Schedule</strong>.</p>
</div>
